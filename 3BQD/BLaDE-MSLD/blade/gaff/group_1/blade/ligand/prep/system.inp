parameters file prep/forcefield.prm

structure file psf prep/system.psf

stream prep/sysinfo.str

selection define lig and segid HYB resid 1
selection define site1sub1 and selection lig atomnames H18A1
selection define site1sub2 and selection lig atomnames C25A2 H18A2 H19A2 H20A2
selection define site1sub3 and selection lig atomnames C25A3 H18A3 H19A3 H20A3 O3A3
selection define site1sub4 and selection lig atomnames C25A4 H18A4 H19A4 H20A4 C26A4 H21A4 H22A4
selection define site1sub5 and selection lig atomnames C25A5 H18A5 H19A5 H20A5 C26A5 H21A5 H22A5 C27A5 H23A5 H24A5
selection define site1sub6 and selection lig atomnames C25A6 H18A6 H19A6 H20A6 C26A6 C27A6 H21A6 O3A6 H22A6 H23A6 H24A6
selection define site1sub7 and selection lig atomnames O3A7 H18A7
selection define site1sub8 and selection lig atomnames C25A8 H18A8 H19A8 H20A8 N5A8 C26A8 H21A8 H22A8 H23A8
selection define site1sub9 and selection lig atomnames O3A9 C25A9 C26A9 H18A9 H19A9 H20A9
selection define site2sub1 and selection lig atomnames H18B1
selection define site2sub2 and selection lig atomnames C25B2 H18B2 H19B2 H20B2
selection define site2sub3 and selection lig atomnames F1B3
selection define site3sub1 and selection lig atomnames H18C1
selection define site3sub2 and selection lig atomnames C25C2 H18C2 H19C2 H20C2
selection print

variables set temp 310.15

coordinates velocity {temp}

msld nblocks {nblocks}

variables set prevblock 0
variables set ii 1
! ii -> site 
while <= {ii} {nsites}
   variables set jj 1
   ! jj -> substituent 
   while <= {jj} {nsubs{ii}}
      variables calculate jp0 int + {jj} {prevblock}

      msld call {jp0} site{ii}sub{jj}

      variables calculate jj int + {jj} 1
   endwhile
   variables calculate prevblock int + {prevblock} {nsubs{ii}}
   variables calculate ii int + {ii} 1
endwhile

!               B S   t0  tv  tm  fb   q
   msld initialize 0 0 0 0 5 0 0

variables set blockassign 0
variables set prevblock 0
variables set ii 1
while <= {ii} {nsites}
   variables set jj 1
   variables set theta0 1
   while <= {jj} {nsubs{ii}}
      variables calculate jp0 int + {jj} {prevblock}

!               B S   t0  tv  tm  fb   q
      msld initialize {jp0} {ii} {theta0} 0 5 {lams{ii}s{jj}} 0

      ! variables set theta0 -1 ! start all equal
      variables calculate jj int + {jj} 1
   endwhile
   variables calculate prevblock int + {prevblock} {nsubs{ii}}
   variables calculate ii int + {ii} 1
endwhile
   msld removescaling bond urey angle  impr 

   msld softcore on
   msld softcore14 off
   ! pmel ex ! msld ewaldtype 2 ! default

variables set prevblock 0
variables set ii 1
while <= {ii} {nsites}
   variables set jj 1
   while <= {jj} {nsubs{ii}}     ! jj and kk specify the substituents 
      variables calculate jp0 int + {jj} {prevblock}
      variables calculate kk int + {jj} 1
      while <= {kk} {nsubs{ii}}
         variables calculate kp0 int + {kk} {prevblock}
         ! put bias potentials here (see manual https://github.com/RyanLeeHayes/BLaDE/blob/master/doc/MAIN.txt )
         ! msld bias lambda1 lambda2 type const coef power 
         !  
         msld bias {jp0} {kp0} 6 0.0 {cs{ii}s{jj}s{ii}s{kk}} 0
         msld bias {jp0} {kp0} 10 -5.56 {xs{ii}s{jj}s{ii}s{kk}} 0
         msld bias {jp0} {kp0} 8 0.017 {ss{ii}s{jj}s{ii}s{kk}} 0
         msld bias {kp0} {jp0} 10 -5.56 {xs{ii}s{kk}s{ii}s{jj}} 0
         msld bias {kp0} {jp0} 8 0.017 {ss{ii}s{kk}s{ii}s{jj}} 0
         variables calculate kk int + {kk} 1
      endwhile
      variables calculate jj int + {jj} 1
   endwhile
   variables calculate prevblock int + {prevblock} {nsubs{ii}}
   variables calculate ii int + {ii} 1
endwhile
